(function(){var w=function(){this.dom=null;this.toolbars=[];this.is_visible=!1;this.hide_on_blur=!0;this.editoroffset=this.toolbarsize=!1;this.mousepos={x:0,y:0};this.lastHighlightedElement=this.lastSrcElement=null;this.allreadyInitialized=!1};CKEDITOR.plugins.add("webjetfloatingtools",{requires:"toolbar",lang:"sk,en,cs",init:function(d){d.ui.addButton("FloatImage",{label:d.lang.webjetfloatingtools.imageProperties,icon:this.path+"image/image.png",name:"floatImage",command:"image"});d.ui.addButton("FloatImageEdit",
{label:d.lang.webjetfloatingtools.imageEdit,icon:this.path+"image/edit.png",name:"floatImageEdit",command:"editImage"});d.ui.addButton("FloatImageDelete",{label:d.lang.webjetfloatingtools.imageDelete,icon:this.path+"image/delete.png",name:"floatImageDelete",command:"deleteImage"});d.ui.addButton("FloatTable",{label:d.lang.webjetfloatingtools.tableProperties,icon:this.path+"image/table.png",name:"floatTable",command:"tableProperties"});d.ui.addButton("FloatTableDelete",{label:d.lang.webjetfloatingtools.tableDelete,
icon:this.path+"image/delete.png",name:"floatTableDelete",command:"deleteTable"});d.ui.addButton("FloatForm",{label:d.lang.webjetfloatingtools.formProperties,icon:this.path+"image/form.png",name:"floatForm",command:"form"});d.ui.addButton("FloatFormDelete",{label:d.lang.webjetfloatingtools.formDelete,icon:this.path+"image/delete.png",name:"floatFormDelete",command:"deleteForm"});d.ui.addButton("FloatDiv",{label:d.lang.webjetfloatingtools.divProperties,icon:this.path+"image/edit.png",name:"floatDiv",
command:"webjetfloatingtoolsDialog"});d.ui.addButton("FloatDivDelete",{label:d.lang.webjetfloatingtools.divDelete,icon:this.path+"image/delete.png",name:"floatDivDelete",command:"deleteDiv"});d.ui.addButton("FloatDivCopy",{label:d.lang.webjetfloatingtools.divCopy,icon:this.path+"image/copy.png",name:"floatDivCopy",command:"copyDiv"});d.ui.addButton("FloatDivDeleteContent",{label:d.lang.webjetfloatingtools.divDeleteContent,icon:this.path+"image/deleteContent.png",name:"floatDivDeleteContent",command:"deleteContentDiv"});
d.addCommand("webjetfloatingtoolsDialog",new CKEDITOR.dialogCommand("webjetfloatingtoolsDialog"));var m=null;CKEDITOR.dialog.addIframe("webjetfloatingtoolsDialog",d.lang.webjetfloatingtools.divProperties,this.path+"dialogs/div_properties.jsp",780,545,function(){function a(a,c){var b=[];""!=a.css("border-"+c+"-width")&&b.push(a.css("border-"+c+"-width"));""!=a.css("border-"+c+"-style")&&b.push(a.css("border-"+c+"-style"));"none"!=b[1]&&""!=a.css("border-"+c+"-color")&&b.push(a.css("border-"+c+"-color"));
return b.join(" ")}ckeditorFixIframeDialog(this.getElement().$);m=document.getElementById(this._.frameId);var b=window.getCkEditorInstance(),c=window.getCkEditorInstance().getSelection(),c=c.getSelectedElement()||c.getStartElement();b.execCommand("hideFloatingTools");null!=b.floatingtools.lastHighlightedElement&&(c=b.floatingtools.lastHighlightedElement,c.$=c);if(null==c)return console.log("Element is null"),!1;b=null;$(c.$).is("div")||$(c.$).is("section")||$(c.$).is("header")?(b=$(c.$).parents("div,header,section").addBack(),
b=$(b.get().reverse())):b=$(c.$).parents("div,header,section");if(null==b)return console.log("Elements are null"),!1;if(-1==m.src.indexOf("?tabs")){var d=[];b.each(function(){var a=$(this).prop("class");""==a&&(a=this.tagName+d.length);d.push(a)});m.src=m.src+"?tabs\x3d"+d.join(encodeURIComponent("|"))}else{var f=[];b.each(function(){var c=$(this),b={};b.cssClass=c.prop("class");b.htmlId=c.prop("id");b.backgroundColor="transparent"!=c[0].style.backgroundColor?c[0].style.backgroundColor:"";b.backgroundImage=
c.get(0).style.backgroundImage;b.backgroundAttachment=c.get(0).style.backgroundAttachment;"rgba(0, 0, 0, 0)"==c[0].style.backgroundColor&&(b.backgroundColor="");""!=b.backgroundImage&&(b.backgroundImage=b.backgroundImage.replace(/(url\(|\)|'|")/gi,""));b.width=c.get(0).style.width;b.height=c.get(0).style.height;b.margin={};b.margin.top=c[0].style.marginTop;b.margin.right=c[0].style.marginRight;b.margin.bottom=c[0].style.marginBottom;b.margin.left=c[0].style.marginLeft;b.border={};b.border.top=a(c,
"top");b.border.right=a(c,"right");b.border.bottom=a(c,"bottom");b.border.left=a(c,"left");b.padding={};b.padding.top=c[0].style.paddingTop;b.padding.right=c[0].style.paddingRight;b.padding.bottom=c[0].style.paddingBottom;b.padding.left=c[0].style.paddingLeft;f.push(b)});m.contentWindow.setData(f)}},{onShow:function(){this.resize(780,450)},onOk:function(){if(null==m)return!0;if(!m.contentWindow.OkClick())return!1;var a=m.contentWindow.getData(),b=window.getCkEditorInstance(),c=b.getSelection(),c=
c.getSelectedElement()||c.getStartElement();null!=b.floatingtools.lastHighlightedElement&&(c=b.floatingtools.lastHighlightedElement,c.$=c);b=null;$(c.$).is("div")||$(c.$).is("section")||$(c.$).is("header")?(b=$(c.$).parents("div,header,section").addBack(),b=$(b.get().reverse())):b=$(c.$).parents("div,header,section");b.each(function(c,b){var d=$(this);if(c<a.length){var e=a[c];""===e.cssClass?d.removeAttr("class"):d.prop("class",e.cssClass);""===e.htmlId?d.removeAttr("id"):d.prop("id",e.htmlId);var h=
{};h["background-color"]=e.backgroundColor;h["background-image"]="url('"+e.backgroundImage+"')";"none"===e.backgroundImage&&(h["background-image"]="none");""!=e.width&&-1==e.width.indexOf("%")&&-1==e.width.indexOf("px")&&(e.width+="px");h.width=e.width;h["min-width"]=e.width;""!=e.height&&-1==e.height.indexOf("%")&&-1==e.height.indexOf("px")&&(e.height+="px");h.height=e.height;h["min-height"]=e.height;h["background-attachment"]=e.backgroundAttachment;$.each(e.data[0],function(a,c){$.each(c,function(c,
b){h[a+"-"+c]=b})});$.each(h,function(a,c){var b=d.css(a);"background-image"===a&&"url('')"===c?h[a]="":0==a.indexOf("border-")&&"0px none"===c&&0==b.indexOf("0px none")?h[a]="":0==a.indexOf("margin-")&&"0px"===c&&"0px"===b?h[a]="":0==a.indexOf("padding-")&&"0px"===c&&"0px"===b&&(h[a]="")});d.css(h);""===d.attr("style")&&d.removeAttr("style")}});return!0},onCancel:function(){var a=window.getCkEditorInstance().document.$.getElementById("actuallyEditedComponent");null!=a&&a.setAttribute("id","")}});
d.addCommand("deleteImage",{exec:function(a){a.execCommand("hideFloatingTools");a=find_element("img",a.getSelection());0<a.length&&a.remove()}});d.addCommand("deleteTable",{exec:function(a){a.execCommand("hideFloatingTools");a=find_element("table",a.getSelection());0<a.length&&a.remove()}});d.addCommand("deleteForm",{exec:function(a){a.execCommand("hideFloatingTools");a=find_element("form",a.getSelection());0<a.length&&a.remove()}});d.addCommand("deleteDiv",{exec:function(a){var b=a.floatingtools.lastHighlightedElement;
a.execCommand("hideFloatingTools");1==b.length?b[0].remove():(b=find_element("div,header,section",a.getSelection()),(void 0==b.attr("id")||-1==b.attr("id").indexOf("wjInline"))&&0<b.length&&b.remove())}});d.addCommand("copyDiv",{exec:function(a){a.execCommand("hideFloatingTools");element=a.floatingtools.lastHighlightedElement;0<element.length&&element.after(element.clone())}});d.addCommand("deleteContentDiv",{exec:function(a){a.execCommand("hideFloatingTools");element=a.floatingtools.lastHighlightedElement;
0<element.length&&element.html("")}});d.addCommand("editImage",{exec:function(a){a.execCommand("hideFloatingTools");a=a.getSelection();if(null!=a&&(a=a.getSelectedElement(),null!=a)){var b=$(a.$).attr("src").split("?")[0];a=b.substring(0,b.lastIndexOf("/"));var b=b.substring(b.lastIndexOf("/")+1),c=990,d=720;1200<screen.height?(c=1300,d=screen.height-150):800<screen.height&&(c=1200,d=screen.height-150);window.open("/admin/v9/apps/image-editor/?iID\x3d-1\x26dir\x3d"+a+"\x26name\x3d"+b,"tinyWindow",
"toolbar\x3dno,scrollbars\x3dyes,resizable\x3dyes,width\x3d"+c+",height\x3d"+d+";")}}});find_element=function(a,b){var c=b.getSelectedElement();if(null!=c&&$(c.$).is(a))return $(c.$);c=b.getStartElement();if(null!=c){if($(c.$).is(a))return $(c.$);c=$(c.$).closest(a);if(0<c.length)return c}return[]};d.on("uiSpace",function(a){a.removeListener();d.floatingtools=new w;for(var b=CKEDITOR.tools.getNextId(),c=["\x3cstyle\x3e",".pos-relative {position:relative}",".cke_floatingtools{","position:absolute;",
"width: auto;","left:-50000px;","top:0;","padding: 5px 0 0 6px;","border:1px solid #b1b1b1;","border-radius:3px;","box-shadow: 0 1px 10px rgba(0,0,0,0.3);","transition:opacity .1s;-o-transition:opacity .1s;-moz-transition:opacity .1s;-webkit-transition:opacity .1s;","}","\x3c/style\x3e",'\x3cspan id\x3d"',b,'" class\x3d"cke_voice_label"\x3e',d.lang.toolbar.toolbars,"\x3c/span\x3e",'\x3cspan id\x3d"'+d.ui.spaceId("floatingtools")+'" class\x3d"cke_floatingtools cke_top" role\x3d"group" aria-labelledby\x3d"',
b,'" onmousedown\x3d"return false;"\x3e'],l,f,b=d.floatingtools.toolbars,k=getFloatingToolbarConfig(d),e=0;e<k.length;e++){var h,g=0,r,n=k[e],m;if(n)if(l&&(c.push("\x3c/span\x3e"),f=l=0),"/"===n)c.push('\x3cspan class\x3d"cke_toolbar_break"\x3e\x3c/span\x3e');else{m=n.items||n;for(var t=0;t<m.length;t++){var p=m[t],u;if(p){var v=function(a){a=a.render(d,c);q=g.items.push(a)-1;0<q&&(a.previous=g.items[q-1],a.previous.next=a);a.toolbar=g};if(p.type==CKEDITOR.UI_SEPARATOR)f=l&&p;else{u=!1!==p.canGroup;
if(!g){h=CKEDITOR.tools.getNextId();g={id:h,items:[]};r=n.name&&(d.lang.toolbar.toolbarGroups[n.name]||n.name);c.push('\x3cspan id\x3d"',h,'" class\x3d"cke_toolbar cke_toolbar_'+n.name+'"',r?' aria-labelledby\x3d"'+h+'_label"':"",' role\x3d"toolbar"\x3e');r&&c.push('\x3cspan id\x3d"',h,'_label" class\x3d"cke_voice_label"\x3e',r,"\x3c/span\x3e");c.push('\x3cspan class\x3d"cke_toolbar_start"\x3e\x3c/span\x3e');var q=b.push(g)-1;0<q&&(g.previous=b[q-1],g.previous.next=g)}u?l||(c.push('\x3cspan class\x3d"cke_toolgroup" role\x3d"presentation"\x3e'),
l=1):l&&(c.push("\x3c/span\x3e"),l=0);f&&(v(f),f=0);v(p)}}}l&&(c.push("\x3c/span\x3e"),f=l=0);g&&c.push('\x3cspan class\x3d"cke_toolbar_end"\x3e\x3c/span\x3e\x3c/span\x3e')}}c.push("\x3c/span\x3e");a.data.html+=c.join("")});d.on("contentDom",function(a){unfocus_toolbar();a=d.editable();if(null!=a){var b=d.document;if(0==d.name.indexOf("wjInline")||-1!=d.name.indexOf("Editor"))b=CKEDITOR.document.getById(d.name);a.attachListener(b,"mouseup",function(a){var b=a.data.$;if(0!==b.button||b.ctrlKey||b.altKey||
b.shiftKey||b.target&&-1!=b.target.className.indexOf("cke_")||b.target&&-1!=b.target.className.indexOf("input"))return!0;removeElementHighlight();d.floatingtools.lastSrcElement=b.target;setTimeout(function(){is_selectable()?(set_mousepos(a.data.$),ckEditorInstance.execCommand("showFloatingTools"),ckEditorInstance.execCommand("changePositionFloatingTools")):ckEditorInstance.execCommand("hideFloatingTools")},100)});a.attachListener(d.window,"scroll",function(a){d.floatingtools.is_visible&&d.execCommand("changePositionFloatingTools")});
b.on("keyup",function(a){a=a.data.$;if(a.target&&-1!=a.target.className.indexOf("input"))return!0;ckEditorInstance.execCommand("hideFloatingTools")});d.on("blur",function(a){d.floatingtools.hide_on_blur&&hide_toolbar()});toolbar=get_element();toolbar.on("mouseover",function(a){focus_toolbar()});toolbar.on("mouseout",function(a){unfocus_toolbar()});d.container.addClass("pos-relative");d.on("mode",function(a){hide_toolbar()});d.on("beforeModeUnload",function(a){try{GridEditorDeinit()}catch(b){}});d.on("afterCommandExec",
function(a){try{if(a.data&&a.data.command&&null!=a.data.command.dialogName)return}catch(b){}try{if(a.data&&a.data.command&&("undo"==a.data.command.name||"redo"==a.data.command.name))return}catch(d){}try{a.data&&a.data.name&&-1==a.data.name.indexOf("FloatingTools")&&(hide_toolbar(),setTimeout(function(){"source"!=ckEditorInstance.mode&&(ckEditorInstance.execCommand("showFloatingTools"),ckEditorInstance.fire("activeFilterChange"))},300))}catch(k){}})}});show_toolbar_section=function(a){$(toolbar.$).find(".cke_toolbar_styles").hide();
$(toolbar.$).find(".cke_toolbar_format").hide();$(toolbar.$).find(".cke_toolbar_paragraph").hide();$(toolbar.$).find(".cke_toolbar_image").hide();$(toolbar.$).find(".cke_toolbar_table").hide();$(toolbar.$).find(".cke_toolbar_form").hide();$(toolbar.$).find(".cke_toolbar_div").hide();$.each(a,function(a,c){$(toolbar.$).find(".cke_toolbar_"+c).show()})};show_toolbar=function(){toolbar.show()};addElementHighlight=function(a){d.floatingtools.lastHighlightedElement=a;a.addClass("cke_floatingtools_selected")};
removeElementHighlight=function(){null!=d.floatingtools.lastHighlightedElement&&d.floatingtools.lastHighlightedElement.removeClass("cke_floatingtools_selected")};d.addCommand("showFloatingTools",{exec:function(a){is_selectable()&&(toolbar=get_element(),unfocus_toolbar(),toolbar.show(),is_text_selected()?show_toolbar_section(["styles","format","paragraph"]):is_img_selected()?show_toolbar_section(["image"]):is_table_selected()?show_toolbar_section(["table"]):is_div_selected()?show_toolbar_section(["div"]):
is_form_selected()&&show_toolbar_section(["form"]),size=get_toolbar_size(),offset=get_editor_offset(),pos=get_mousepos(),toolpos=calculate_position(pos,size,offset),0==is_text_selected()&&(is_table_selected()||is_img_selected()||is_form_selected()||is_div_selected())&&(toolpos=calculate_position_fixed(a,pos,size,offset)),toolbar.setStyles({left:toolpos.x+"px",top:toolpos.y+"px"}),a.floatingtools.is_visible=!0)}});d.addCommand("changePositionFloatingTools",{exec:function(a){var b=get_element();0>parseInt($(b.$).css("left"))||
(size=get_toolbar_size(),offset=get_editor_offset(),pos=get_mousepos(),toolpos=calculate_position(pos,size,offset),0==is_text_selected()&&(is_table_selected()||is_img_selected()||is_form_selected()||is_div_selected())&&(toolpos=calculate_position_fixed(a,pos,size,offset)),b.setStyles({left:toolpos.x+"px",top:toolpos.y+"px"}),a.floatingtools.is_visible=!0)}});d.addCommand("hideFloatingTools",{exec:function(a){hide_toolbar()}});hide_toolbar=function(){0!=d.floatingtools.is_visible&&(toolbar=get_element(),
toolbar.hide(),d.floatingtools.is_visible=!1,removeElementHighlight())};set_mousepos=function(a){var b=d.window.getScrollPosition();d.floatingtools.mousepos={left:a.clientX,top:a.clientY+b.y}};get_mousepos=function(){return d.floatingtools.mousepos};get_element=function(){if(!ckEditorInstance.floatingtools.dom){var a=ckEditorInstance.ui.spaceId("floatingtools");ckEditorInstance.floatingtools.dom=CKEDITOR.document.getById(a)}return ckEditorInstance.floatingtools.dom};get_editor_offset=function(){if(!d.floatingtools.editoroffset){var a=
d.ui.spaceId("contents"),a=CKEDITOR.document.getById(a);if(null!=a)d.floatingtools.editoroffset={left:a.$.offsetLeft,top:a.$.offsetTop,width:a.$.offsetWidth,height:a.$.offsetHeight};else{a=document.getElementById("wjInlineCkEditorToolbarOffsetElement");if(null!=a)return{left:-a.offsetLeft,top:-34,width:a.offsetWidth,height:a.offsetHeight};d.floatingtools.editoroffset={left:0,top:0,width:0,height:0}}}return d.floatingtools.editoroffset};calculate_position=function(a,b,c){var l=parseInt($("#cke_1_contents").css("border-top-width"));
isNaN(l)&&(l=0);var f=d.window.getScrollPosition();toolpos={x:a.left+c.left-b.width/2,y:a.top+c.top-f.y-(b.height+20)+l};toolpos.x<c.left+2&&(toolpos.x=c.left+2);a.left+b.width/2>=c.left+c.width-2&&(toolpos.x=c.left+c.width-b.width-2);1>l&&c.top+a.top>toolpos.y&&c.top+a.top<toolpos.y+b.height&&(toolpos.y=c.top+a.top+24);return toolpos};find_form_element=function(a){if(null==a)return[];a=$(a.$);return a.is("form")?a:0<a.parents("form").first().length?a.parents("form").first():[]};calculate_position_fixed=
function(a,b,c,d){var f=$("#cke_1_top").outerHeight()-8;0<$("div.wj-control-line").length&&(f=-$("div.wj-control-line").outerHeight()-8);var k=a.getSelection(),e=k.getSelectedElement(),h=k.getStartElement(),g=k=null;is_img_selected()?(null!=e&&(g=$(e.$).closest("img")),null==g&&(g=$(h.$).closest("img"))):is_table_selected()?(null!=e&&(g=$(e.$).closest("table")),null==g&&(g=$(h.$).closest("table"))):is_div_selected()?(g=$(a.floatingtools.lastSrcElement).closest("div,header,section"),1==g.length&&($(g[0]).hasClass("row")||
$(g[0]).hasClass("container"))&&(e=$(a.floatingtools.lastSrcElement).closest("header,section"),1==e.length&&(g=e))):is_form_selected()&&(null!=e&&(g=$(e.$).closest("form")),null==g&&(g=$(h.$).closest("form")));a=a.window.getScrollPosition();null!=g&&(k=g.offset());return null!=k?(addElementHighlight(g),b=a.x+k.left+g.outerWidth()/2-c.width/2,f=f+k.top-a.y-c.height,b<c.width/2&&(b=c.width/2),-1>d.left&&(b+=d.left,f+=d.top,f-=10),toolpos={x:b,y:f}):calculate_position(b,c,d)};get_toolbar_size=function(){var a=
get_element();d.floatingtools.toolbarsize={width:0,height:36};for(var b=0,c=a.$.children.length,b=0;b<c;b++)d.floatingtools.toolbarsize.width+=a.$.children[b].offsetWidth;a=document.getElementById("cke_1_top").offsetTop;return{width:d.floatingtools.toolbarsize.width+8,height:d.floatingtools.toolbarsize.height+a}};is_selectable=function(){return null!=CKEDITOR.dialog.getCurrent()?!1:is_text_selected()||is_img_selected()||is_table_selected()||is_form_selected()||is_div_selected()};is_text_selected=
function(){var a=ckEditorInstance.getSelection().getSelectedText();return null==a||" "==a?!1:""!=a};is_img_selected=function(){var a=ckEditorInstance.getSelection().getSelectedElement();if(null!=a)return a.is("img")};is_table_selected=function(){var a=ckEditorInstance.getSelection().getSelectedElement(),b=ckEditorInstance.getSelection().getStartElement();return null!=a?a.is("table"):null!=b?(a=b.is("td")||b.is("th"),0==a&&null!=b.$.parentElement&&(b=b.$.parentElement.tagName,"TD"==b||"TH"==b)?!0:
a):!1};is_form_selected=function(){var a=ckEditorInstance.getSelection().getSelectedElement(),b=ckEditorInstance.getSelection().getStartElement(),c=!1;null!=a?c=0<$(a.$).parents("form").first().length:null!=b&&(c=b.is("form")||0<$(b.$).parents("form").first().length);return c};is_div_selected=function(){var a=d.floatingtools.lastSrcElement;if(void 0==a)return!1;a.$=a;if("SECTION"==a.tagName||"HEADER"==a.tagName||"DIV"==a.tagName)return!0;if(null!=a)return $(a.$).parents("div").first().hasClass("cke_editable")?
!1:0<$(a.$).parents("div,header,section").first().length};focus_toolbar=function(){obj=get_element();obj.setOpacity(1)};unfocus_toolbar=function(){obj=get_element();obj.setOpacity(.5)};getFloatingToolbarConfig=function(a){function b(){var b=getPrivateFloatingToolbarGroups(a);return d(b)}function c(b,c){if(c.length){b.items?b.items.push(a.ui.create("-")):b.items=[];for(var d;d=c.shift();)d="string"==typeof d?d:d.name,f&&-1!=CKEDITOR.tools.indexOf(f,d)||(d=a.ui.create(d))&&a.addFeature(d)&&b.items.push(d)}}
function d(a){var b=[],g,f,k;for(g=0;g<a.length;++g)f=a[g],k={},"/"==f?b.push(f):CKEDITOR.tools.isArray(f)?(c(k,CKEDITOR.tools.clone(f)),b.push(k)):f.items&&(c(k,CKEDITOR.tools.clone(f.items)),k.name=f.name,b.push(k));return b}var f=a.config.removeButtons,f=f&&f.split(","),k=a.config.floatingtools;"string"==typeof k&&(k=a.config["floatingtools_"+k]);return a.toolbar=k?d(k):b()};getPrivateFloatingToolbarGroups=function(a){return a._.floatingToolsGroups||(a._.floatingToolsGroups=a.config.floatingToolsGroups)}}})})();